{% load custom_filters %}
<div class="modal-header">
    <p class="h6">{{ titulo }} </p>
</div>
<div class="modal-body">
    <div class="row">

        <div class="col-lg-12">
            <div class="row">
                <div class="col-3 text-end"><p class="fw-bold">Ejercicio:</p></div>
                <div class="col-9"><p>{{ cabecera.ejerOP }}</p></div>
            </div>
        </div>

        <div class="col-lg-12">
            <div class="row">
                <div class="col-3 text-end"><p class="fw-bold">Jur:</p></div>
                <div class="col-2"><p>{{ cabecera.jurisdiccion }}</p></div>
                <div class="col-3 text-end"><p class="fw-bold">UDO:</p></div>
                <div class="col-4"><p>{{ cabecera.udo }}</p></div>
            </div>
        </div>

         <div class="col-lg-12">
            <div class="row">
                <div class="col-3 text-end"><p class="fw-bold">Lugar:</p></div>
                <div class="col-9"><p>{{ cabecera.lugar }}</p></div>
            </div>
        </div>

        <div class="col-lg-12">
            <div class="row">
                <div class="col-3 text-end"><p class="fw-bold">Beneficiario:</p></div>
                <div class="col-9"><p>{{ cabecera.cuit }} - {{ cabecera.nombreProveedor }}</p></div>
            </div>
        </div>

        <div class="col-lg-12">
            <div class="row">
                <div class="col-3 text-end"><p class="fw-bold">Beneficiario del Pago:</p></div>
                <div class="col-9"><p>{{ cabecera.paguese }}</p></div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-lg-12 table-responsive">
            <table id="data_table_detalle" class="table table-bordered table-striped table-hover small">
              <thead>
                <tr>
                    <th width="15%">Año Const.</th>
                    <th width="10%">N° Const.</th>
                    <th width="15%">Fec.</th>
                    <th width="15%">Cod. Oper.</th>
                    <th width="15%">Alic.</th>
                    <th width="20%">Imp. Ret.</th>
                    <th width="2%"></th>
                </tr>
              </thead>
              <tbody>
                {% for row in detalle %}
                 <tr>
                 <td>{{ row.ejerConstancia }}</td>
                 <td>{{ row.nroConstancia }}</td>
                 <td>{{ row.fecRetencion|formato_fecha }}</td>
                 <td>{{ row.tipoRetencion }}</td>
                 <td align="right">{{ row.ImporteAlicuota }}</td>
                 <td align="right">{{ row.ImporteRetenido|formatear_numero }}</td>
                 <td align="center"><button type="button" onclick="verPdfRetencion(`{{ row.tipoRetencion }}`,`{{row.ejerConstancia}}`,`{{row.nroConstancia}}`,`{{row.tipoRetencion}}`)" class="btn btn-outline-secondary js-detalle" title="Comprobante"><i class="fa fa-file-pdf-o"></i></button></td>
                 </tr>
                {% endfor %}
              </tbody>
            </table>
        </div>
    </div>

</div>
<div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" data-bs-dismiss="modal">Cerrar</button>
</div>


<script>

    function verPdfRetencion(tipo, anio, cons, trenro){

    $(".aux").html('<form id="verPdf" action="{% url 'op_retenciones_pdf' %}" target="_blank" method="POST">{%  csrf_token %}' +
        '<input name="tipo" value="'+tipo+'"/>' +
        '<input name="anio" value="'+anio+'"/>' +
        '<input name="cons" value="'+cons+'"/>' +
        '<input name="trenro" value="'+trenro+'"/>' +
        '</form>');

    $("#verPdf").submit();

    $(".aux").html('');

   }
</script>